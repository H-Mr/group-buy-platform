server:
  port: ${APP_PORT} # 容器内部端口

# 线程池配置
thread:
  pool:
    # 1. 核心业务 DAG 专用
    dag:
      core-pool-size: 50
      max-pool-size: 200
      block-queue-size: 2000
      keep-alive-time: 5000
      name-prefix: "dag-exec-"
      reject-policy: CallerRunsPolicy
    # 2. 消息通知 EventBus 专用
    notify:
      core-pool-size: 5
      max-pool-size: 20
      block-queue-size: 500
      keep-alive-time: 5000
      name-prefix: "event-bus-"
      reject-policy: CallerRunsPolicy
    # 3. 通用异步任务专用
    common:
      core-pool-size: 5
      max-pool-size: 20
      block-queue-size: 500
      keep-alive-time: 5000
      name-prefix: "async-task-"
      reject-policy: CallerRunsPolicy

# 应用配置
app:
  config:
    # 版本，方便通过接口版本升级
    api-version: v1
    # 跨域，开发阶段可以设置为 * 不限制
    cross-origin: '*'
    # SC 渠道配置 - 拼团对接渠道值、回调通知
    group-buy-market:
      api-url: http://127.0.0.1:8091
      notify-url: http://127.0.0.1:8080/api/v1/alipay/group_buy_notify
      source: s01
      chanel: c01


# 数据库配置；启动时配置数据库资源信息
spring:
  datasource:
    username: root
    password: 123456
    url: jdbc:mysql://${SERVER_HOST}:13306/${MYSQL_DATABASE}?useUnicode=true&characterEncoding=utf8&autoReconnect=true&zeroDateTimeBehavior=convertToNull&serverTimezone=Asia/Shanghai&useSSL=true
    driver-class-name: com.mysql.cj.jdbc.Driver
    hikari:
      pool-name: Retail_HikariCP
      minimum-idle: 15 #最小空闲连接数量
      idle-timeout: 180000 #空闲连接存活最大时间，默认600000（10分钟）
      maximum-pool-size: 25 #连接池最大连接数，默认是10
      auto-commit: true  #此属性控制从池返回的连接的默认自动提交行为,默认值：true
      max-lifetime: 1800000 #此属性控制池中连接的最长生命周期，值0表示无限生命周期，默认1800000即30分钟
      connection-timeout: 30000 #数据库连接超时时间,默认30秒，即30000
      connection-test-query: SELECT 1
    type: com.zaxxer.hikari.HikariDataSource

# MyBatis 配置
mybatis:
  mapper-locations: classpath:/mybatis/mapper/*.xml
  config-location:  classpath:/mybatis/config/mybatis-config.xml
  type-aliases-package: cn.hjw.dev.infrastructure.dao.po


# Redis
redis:
  sdk:
    config:
      host: ${SERVER_HOST}
      port: 16379
      pool-size: 10
      min-idle-size: 5
      idle-timeout: 30000
      connect-timeout: 5000
      retry-attempts: 3
      retry-interval: 1000
      ping-interval: 60000
      keep-alive: true

# 微信公众号对接
weixin:
  config:
    originalid: ${WEIXIN_ORIGINAL_ID}
    token: ${WEIXIN_TOKEN}
    app-id: ${WEIXIN_APP_ID}
    app-secret: ${WEIXIN_APP_SECRET}
    template_id: luFYa6dPjgxv3Adr6tIxeXgxtXT2er2jwSGprZb-S5w


jwt:
  secret: ${JWT_SECRET}
  expire: 7200 # Token有效期（秒）(2小时)

# 支付宝支付 - 沙箱 https://opendocs.alipay.com/common/02kkv7
alipay:
  app_id: ${ALIPAY_APP_ID}
  alipay_public_key: ${ALIPAY_PUBLIC_KEY}
  merchant_private_key: ${ALIPAY_PRIVATE_KEY}
  gatewayUrl: https://openapi-sandbox.dl.alipaydev.com/gateway.do
  notify_url: ${ALIPAY_PAY_NOTIFY_HOST}/api/v1/alipay/alipay_notify_url
  return_url:  ${ALIPAY_PAY_NOTIFY_HOST}/success.html


# 日志配置（匹配 Logback 中的 LOG_PATH 变量）
logging:
  level:
    root: INFO
    cn.hjw.dev: DEBUG  # 开发环境日志级别设为 DEBUG，方便调试
  file:
    path: logs


# Spring Boot Actuator 配置（健康检查核心）
management:
  endpoints:
    web:
      exposure:
        include: health  # 暴露健康检查端点（生产环境仅暴露必要端点，避免安全风险）
      base-path: /actuator  # 端点根路径（默认就是/actuator，可省略）
  endpoint:
    health:
      show-details: always  # 显示健康检查详情（方便调试，生产可改为when_authorized）
  health:
    redis:
      enabled: true  # 检查Redis连接状态
    db:
      enabled: true  # 检查MySQL数据库连接状态